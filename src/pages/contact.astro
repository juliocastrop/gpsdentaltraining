---
/**
 * Contact Page - GPS Dental Training
 * Contact form, location info, and business hours
 */
import PageLayout from '../layouts/PageLayout.astro';
import Section from '../components/ui/Section.astro';
import SectionHeader from '../components/ui/SectionHeader.astro';
import Card from '../components/ui/Card.astro';
import IconBox from '../components/ui/IconBox.astro';
import { supabaseAdmin } from '../lib/supabase/client';

// Fetch page content from database
const { data: pageData } = await supabaseAdmin
  .from('pages')
  .select('*')
  .eq('slug', 'contact')
  .eq('status', 'published')
  .single();

// Content with defaults
const content = pageData?.content || {};
const address = content.address || {
  line1: "6320 Sugarloaf Parkway",
  city: "Duluth",
  state: "GA",
  zip: "30097",
  country: "United States"
};
const phone = content.phone || "(770) 232-0240";
const email = content.email || "info@gpsdentaltraining.com";
const hours = content.hours || {
  weekdays: "Monday - Friday: 8:00 AM - 5:00 PM EST",
  weekend: "Saturday - Sunday: Closed"
};
const social = content.social || {
  facebook: "https://www.facebook.com/gpsdentaltraining",
  instagram: "https://www.instagram.com/gpsdentaltraining",
  linkedin: "https://www.linkedin.com/company/gps-dental-training",
  youtube: "https://www.youtube.com/@gpsdentaltraining"
};

const fullAddress = `${address.line1}, ${address.city}, ${address.state} ${address.zip}`;
const mapsUrl = `https://maps.google.com/?q=${encodeURIComponent(fullAddress)}`;
---

<PageLayout
  title={pageData?.meta_title || "Contact Us"}
  description={pageData?.meta_description || "Contact GPS Dental Training for information about our dental courses, seminars, and continuing education programs."}
  breadcrumbs={[{ label: 'Contact' }]}
  heroTitle="Get in"
  heroTitleAccent="Touch"
  heroDescription="Have questions about our courses or seminars? We're here to help. Reach out to us and we'll respond as soon as possible."
  heroBadge={{ icon: 'phone', text: 'Contact Us' }}
>
  <!-- Contact Info Cards -->
  <Section bg="white" padding="lg">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto mb-16">
      <!-- Phone -->
      <Card variant="outline" hover padding="lg" class="text-center">
        <IconBox variant="gold" size="xl" class="mx-auto mb-6">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
          </svg>
        </IconBox>
        <h3 class="text-xl font-bold text-[#13326A] mb-2">Call Us</h3>
        <a href={`tel:${phone.replace(/[^0-9]/g, '')}`} class="text-[#0B52AC] font-semibold text-lg hover:underline">
          {phone}
        </a>
        <p class="text-[#4E6E82] text-sm mt-2">Mon-Fri, 8am-5pm EST</p>
      </Card>

      <!-- Email -->
      <Card variant="outline" hover padding="lg" class="text-center">
        <IconBox variant="navy" size="xl" class="mx-auto mb-6">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
        </IconBox>
        <h3 class="text-xl font-bold text-[#13326A] mb-2">Email Us</h3>
        <a href={`mailto:${email}`} class="text-[#0B52AC] font-semibold text-lg hover:underline break-all">
          {email}
        </a>
        <p class="text-[#4E6E82] text-sm mt-2">We'll respond within 24 hours</p>
      </Card>

      <!-- Location -->
      <Card variant="outline" hover padding="lg" class="text-center">
        <IconBox variant="gold" size="xl" class="mx-auto mb-6">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        </IconBox>
        <h3 class="text-xl font-bold text-[#13326A] mb-2">Visit Us</h3>
        <p class="text-[#4E6E82]">
          {address.line1}<br />
          {address.city}, {address.state} {address.zip}
        </p>
        <a href={mapsUrl} target="_blank" rel="noopener" class="text-[#0B52AC] font-semibold text-sm hover:underline inline-flex items-center gap-1 mt-2">
          Get Directions
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </a>
      </Card>
    </div>

    <!-- Contact Form & Map -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 max-w-6xl mx-auto">
      <!-- Contact Form -->
      <div>
        <h2 class="text-2xl font-bold text-[#13326A] mb-6">Send Us a Message</h2>
        <form id="contact-form" class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="firstName" class="block text-sm font-semibold text-[#13326A] mb-2">
                First Name *
              </label>
              <input
                type="text"
                id="firstName"
                name="firstName"
                required
                class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#0B52AC] focus:ring-2 focus:ring-[#0B52AC]/20 outline-none transition-all"
                placeholder="John"
              />
            </div>
            <div>
              <label for="lastName" class="block text-sm font-semibold text-[#13326A] mb-2">
                Last Name *
              </label>
              <input
                type="text"
                id="lastName"
                name="lastName"
                required
                class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#0B52AC] focus:ring-2 focus:ring-[#0B52AC]/20 outline-none transition-all"
                placeholder="Doe"
              />
            </div>
          </div>

          <div>
            <label for="email" class="block text-sm font-semibold text-[#13326A] mb-2">
              Email Address *
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#0B52AC] focus:ring-2 focus:ring-[#0B52AC]/20 outline-none transition-all"
              placeholder="john@example.com"
            />
          </div>

          <div>
            <label for="phone" class="block text-sm font-semibold text-[#13326A] mb-2">
              Phone Number
            </label>
            <input
              type="tel"
              id="phone"
              name="phone"
              class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#0B52AC] focus:ring-2 focus:ring-[#0B52AC]/20 outline-none transition-all"
              placeholder="(555) 123-4567"
            />
          </div>

          <div>
            <label for="subject" class="block text-sm font-semibold text-[#13326A] mb-2">
              Subject *
            </label>
            <select
              id="subject"
              name="subject"
              required
              class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#0B52AC] focus:ring-2 focus:ring-[#0B52AC]/20 outline-none transition-all bg-white"
            >
              <option value="">Select a topic...</option>
              <option value="courses">Course Information</option>
              <option value="seminars">Monthly Seminars</option>
              <option value="registration">Registration Help</option>
              <option value="ce-credits">CE Credits</option>
              <option value="partnership">Partnership Inquiry</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div>
            <label for="message" class="block text-sm font-semibold text-[#13326A] mb-2">
              Message *
            </label>
            <textarea
              id="message"
              name="message"
              required
              rows="5"
              class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#0B52AC] focus:ring-2 focus:ring-[#0B52AC]/20 outline-none transition-all resize-none"
              placeholder="How can we help you?"
            ></textarea>
          </div>

          <button
            type="submit"
            class="w-full bg-[#0B52AC] text-white px-8 py-4 rounded-xl font-bold text-lg hover:bg-[#13326A] transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2"
          >
            Send Message
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
            </svg>
          </button>
        </form>
      </div>

      <!-- Map & Hours -->
      <div>
        <!-- Map -->
        <div class="bg-gray-100 rounded-2xl overflow-hidden h-80 mb-8">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3308.5!2d-84.1447!3d34.0!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x88f5a3c7a!2s6320+Sugarloaf+Pkwy,+Duluth,+GA+30097!5e0!3m2!1sen!2sus!4v1234567890"
            width="100%"
            height="100%"
            style="border:0;"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="GPS Dental Training Location"
          ></iframe>
        </div>

        <!-- Business Hours -->
        <Card variant="gray" padding="lg">
          <h3 class="text-xl font-bold text-[#13326A] mb-6 flex items-center gap-3">
            <svg class="w-6 h-6 text-[#DDC89D]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            Business Hours
          </h3>

          <div class="space-y-4">
            <div class="flex justify-between items-center pb-3 border-b border-gray-200">
              <span class="text-[#4E6E82]">Monday - Friday</span>
              <span class="font-semibold text-[#13326A]">8:00 AM - 5:00 PM</span>
            </div>
            <div class="flex justify-between items-center pb-3 border-b border-gray-200">
              <span class="text-[#4E6E82]">Saturday</span>
              <span class="font-semibold text-[#13326A]">Closed</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-[#4E6E82]">Sunday</span>
              <span class="font-semibold text-[#13326A]">Closed</span>
            </div>
          </div>

          <p class="text-sm text-[#4E6E82] mt-6">
            * Course schedules may vary. Check individual course pages for specific times.
          </p>
        </Card>

        <!-- Social Links -->
        <div class="mt-8">
          <h3 class="text-lg font-bold text-[#13326A] mb-4">Follow Us</h3>
          <div class="flex gap-4">
            {social.facebook && (
              <a href={social.facebook} target="_blank" rel="noopener" class="w-12 h-12 bg-[#13326A] text-white rounded-xl flex items-center justify-center hover:bg-[#0B52AC] transition-colors">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
              </a>
            )}
            {social.instagram && (
              <a href={social.instagram} target="_blank" rel="noopener" class="w-12 h-12 bg-[#13326A] text-white rounded-xl flex items-center justify-center hover:bg-[#0B52AC] transition-colors">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                </svg>
              </a>
            )}
            {social.linkedin && (
              <a href={social.linkedin} target="_blank" rel="noopener" class="w-12 h-12 bg-[#13326A] text-white rounded-xl flex items-center justify-center hover:bg-[#0B52AC] transition-colors">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
              </a>
            )}
            {social.youtube && (
              <a href={social.youtube} target="_blank" rel="noopener" class="w-12 h-12 bg-[#13326A] text-white rounded-xl flex items-center justify-center hover:bg-[#0B52AC] transition-colors">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                </svg>
              </a>
            )}
          </div>
        </div>
      </div>
    </div>
  </Section>

  <!-- FAQ Section -->
  <Section bg="gray" padding="lg">
    <SectionHeader
      badge="Common Questions"
      title="Frequently Asked Questions"
    />

    <div class="max-w-3xl mx-auto space-y-4">
      <Card variant="white" padding="md">
        <details class="group">
          <summary class="flex items-center justify-between cursor-pointer list-none">
            <h3 class="text-lg font-bold text-[#13326A]">How do I register for a course?</h3>
            <svg class="w-5 h-5 text-[#4E6E82] group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <p class="text-[#4E6E82] mt-4 leading-relaxed">
            You can register for any course directly on our website by visiting the course page and clicking "Add to Cart." Complete the checkout process with your payment information, and you'll receive a confirmation email with your ticket and course details.
          </p>
        </details>
      </Card>

      <Card variant="white" padding="md">
        <details class="group">
          <summary class="flex items-center justify-between cursor-pointer list-none">
            <h3 class="text-lg font-bold text-[#13326A]">What is your cancellation policy?</h3>
            <svg class="w-5 h-5 text-[#4E6E82] group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <p class="text-[#4E6E82] mt-4 leading-relaxed">
            Cancellations made 30 days or more before the course date are eligible for a full refund minus a processing fee. Cancellations made 15-29 days before receive a 50% refund. No refunds are available for cancellations made less than 15 days before the course. Please contact us for transfers or special circumstances.
          </p>
        </details>
      </Card>

      <Card variant="white" padding="md">
        <details class="group">
          <summary class="flex items-center justify-between cursor-pointer list-none">
            <h3 class="text-lg font-bold text-[#13326A]">How do I receive my CE credits?</h3>
            <svg class="w-5 h-5 text-[#4E6E82] group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <p class="text-[#4E6E82] mt-4 leading-relaxed">
            CE credits are automatically awarded upon course completion and attendance verification. You'll receive a certificate via email within 5 business days after the course. All credits are reported to the appropriate dental boards and can also be accessed through your GPS Dental Training account.
          </p>
        </details>
      </Card>

      <Card variant="white" padding="md">
        <details class="group">
          <summary class="flex items-center justify-between cursor-pointer list-none">
            <h3 class="text-lg font-bold text-[#13326A]">Are meals included with courses?</h3>
            <svg class="w-5 h-5 text-[#4E6E82] group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <p class="text-[#4E6E82] mt-4 leading-relaxed">
            Yes! Multi-day courses include breakfast, lunch, and refreshments. For single-day courses, lunch and refreshments are provided. Please let us know of any dietary restrictions when you register.
          </p>
        </details>
      </Card>
    </div>
  </Section>
</PageLayout>

<script>
  // Contact form handling
  const form = document.getElementById('contact-form');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(form as HTMLFormElement);
    const data = Object.fromEntries(formData.entries());

    // For now, just show an alert - in production, this would submit to an API
    alert('Thank you for your message! We will get back to you within 24 hours.');
    (form as HTMLFormElement).reset();
  });
</script>
